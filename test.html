<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Set vs Sparse Array Benchmark</title>
    <script>
        function benchmark() {
            const gridSize = 100000000;
            const sparsityLevels = [0.1, 0.01, 0.001];
            let results = "";

            sparsityLevels.forEach(sparsity => {
                const elementCount = Math.floor(gridSize * sparsity);
                let set = new Set();
                let sparseArray = {};
                let testValues = [];

                console.log(`Benchmarking sparsity: ${sparsity}`);
                
                // Populate data structures
                let start = performance.now();
                for (let i = 0; i < elementCount; i++) {
                    let val = Math.floor(Math.random() * gridSize);
                    set.add(val);
                    sparseArray[val] = true;
                    testValues.push(val);
                }
                let creationTime = performance.now() - start;

                // Lookup test
                start = performance.now();
                testValues.forEach(v => { let exists = set.has(v); });
                let setLookupTime = performance.now() - start;

                start = performance.now();
                testValues.forEach(v => { let exists = sparseArray[v] !== undefined; });
                let sparseArrayLookupTime = performance.now() - start;

                // Iteration test
                start = performance.now();
                for (let val of set) {};
                let setIterationTime = performance.now() - start;

                start = performance.now();
                for (let key in sparseArray) {};
                let sparseArrayIterationTime = performance.now() - start;

                // Deletion test
                start = performance.now();
                testValues.forEach(v => set.delete(v));
                let setDeletionTime = performance.now() - start;

                start = performance.now();
                testValues.forEach(v => delete sparseArray[v]);
                let sparseArrayDeletionTime = performance.now() - start;

                results += `Sparsity: ${sparsity}\n`
                    + `Creation Time: Set ${creationTime.toFixed(2)}ms, Sparse Array ${creationTime.toFixed(2)}ms\n`
                    + `Lookup Time: Set ${setLookupTime.toFixed(2)}ms, Sparse Array ${sparseArrayLookupTime.toFixed(2)}ms\n`
                    + `Iteration Time: Set ${setIterationTime.toFixed(2)}ms, Sparse Array ${sparseArrayIterationTime.toFixed(2)}ms\n`
                    + `Deletion Time: Set ${setDeletionTime.toFixed(2)}ms, Sparse Array ${sparseArrayDeletionTime.toFixed(2)}ms\n\n`;
            });

            document.getElementById("results").textContent = results;
        }
    </script>
</head>
<body>
    <h1>Set vs Sparse Array Benchmark</h1>
    <button onclick="benchmark()">Run Benchmark</button>
    <pre id="results"></pre>
</body>
</html>
